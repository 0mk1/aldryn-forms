{% load i18n sekizai_tags cms_tags %}

<form method="post" class="aldryn aldryn-forms{% block form_classes %}{% if instance.custom_classes %} {{ instance.custom_classes }}{% endif %}{% endblock form_classes %}" role="form">
    {% csrf_token %}
    {% for field in form.hidden_fields %}{{ field }}{% endfor %}

    {% if form.non_field_errors %}
    <div class="alert alert-danger" role="alert">
        {% for error in form.non_field_errors %}
        <p>{{ error }}</p>
        {% endfor %}
    </div>
    {% endif %}

    {% if form_success_url %}
    <div class="alert alert-success" role="alert">
        <p>{% trans "Thank you for submitting your information, you will be redirected shortly." %}</p>
    </div>
    {% endif %}

    {% for plugin in instance.child_plugin_instances %}
        {% render_plugin plugin %}
    {% endfor %}
</form>

{# INFO: this hack is currently required as backend does not know where to redirect #}
{% if form_success_url %}
{% addtoblock "js" %}
<script>
setTimeout(function () {
    // window.location.reload('{{ form_success_url }}');
    alert('SCUEESS');
}, 2000);
</script>
{% endaddtoblock %}
{% endif %}
